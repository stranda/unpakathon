<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="A Strand" />

<meta name="date" content="2019-07-02" />

<title>Getting going with unpak data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Getting going with unpak data</h1>
<h4 class="author">A Strand</h4>
<h4 class="date">2019-07-02</h4>



<p>The unpakathon package is primarily a datafreeze of the unpak database. It also provides some functions to help work with these data.</p>
<p>This vignette shows how to interact with these data, once the package is installed and loaded into the current R session</p>
<p>load the library</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(unpakathon)</code></pre></div>
<pre><code>## Loading required package: adjustPhenotypes</code></pre>
<pre><code>## Loading required package: dplyr</code></pre>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## Loading required package: knitr</code></pre>
<pre><code>## Loading required package: reshape</code></pre>
<pre><code>## 
## Attaching package: 'reshape'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     rename</code></pre>
<pre><code>## Loading required package: rmarkdown</code></pre>
<pre><code>## Loading required package: GGally</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Registered S3 method overwritten by 'GGally':
##   method from   
##   +.gg   ggplot2</code></pre>
<pre><code>## 
## Attaching package: 'GGally'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     nasa</code></pre>
<pre><code>## Loading required package: igraph</code></pre>
<pre><code>## 
## Attaching package: 'igraph'</code></pre>
<pre><code>## The following objects are masked from 'package:dplyr':
## 
##     as_data_frame, groups, union</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     union</code></pre>
<pre><code>## Loading required package: ggrepel</code></pre>
<pre><code>## Loading required package: VCA</code></pre>
<div id="how-do-i-know-how-fresh-the-data-are" class="section level1">
<h1>How do I know how fresh the data are?</h1>
<p>After loading the package up using ‘library()’, the date of the snapshot is available:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datestamp</code></pre></div>
<pre><code>##              snapshot.date
## 1 Mon Jul  1 21:28:36 2019</code></pre>
</div>
<div id="tables" class="section level1">
<h1>Tables</h1>
<p>There are several tables available, each with some sort of help description that you can access by typing ?<tbl> (e.g. ?phenolong or ?independent)</p>
<p>Here are the tables at the moment and a list of their current column names</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#phenolong: long format for all the phenotypic data</span>
<span class="kw">names</span>(phenolong)</code></pre></div>
<pre><code>##  [1] &quot;plantID&quot;         &quot;accession&quot;       &quot;treatment&quot;      
##  [4] &quot;experiment&quot;      &quot;meta.experiment&quot; &quot;facility&quot;       
##  [7] &quot;variable&quot;        &quot;value&quot;           &quot;block&quot;          
## [10] &quot;flat&quot;            &quot;row&quot;             &quot;col&quot;            
## [13] &quot;Gene_idGene&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#phenowide: wide (typical) format for phenotypic data in phenolong</span>
<span class="kw">names</span>(independent)</code></pre></div>
<pre><code>##  [1] &quot;id&quot;                          &quot;Accession_idAccession&quot;      
##  [3] &quot;Gene_idGene&quot;                 &quot;ConservedGroup&quot;             
##  [5] &quot;ProteinLevel&quot;                &quot;InsertLocation&quot;             
##  [7] &quot;AverageExpress7DaySeedling&quot;  &quot;StdDevExpress7DaySeedling&quot;  
##  [9] &quot;AverageExpressRosetteLeaf2&quot;  &quot;StdDevRosetteLeaf2&quot;         
## [11] &quot;AverageExpressRosetteLeaf4&quot;  &quot;AverageExpressRosetteLeaf6&quot; 
## [13] &quot;AverageExpressFlowerStage9&quot;  &quot;AverageExpressFlowerStage12&quot;
## [15] &quot;AverageExpressFlowerStage15&quot; &quot;accession&quot;                  
## [17] &quot;locus&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##tdna: tdna data we know what it is.  indexed by accession
<span class="kw">names</span>(tdna)</code></pre></div>
<pre><code>##  [1] &quot;Accession_idAccession&quot; &quot;Endolocus&quot;            
##  [3] &quot;EndoArea&quot;              &quot;TDNAArea&quot;             
##  [5] &quot;AreaRatio&quot;             &quot;RepsUsed&quot;             
##  [7] &quot;RepsFailed&quot;            &quot;RatioCat&quot;             
##  [9] &quot;TimeStamp&quot;             &quot;accession&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#geneont The tair10 gene ontology indexed by gene</span>
<span class="kw">names</span>(geneont)</code></pre></div>
<pre><code>##  [1] &quot;row_names&quot;    &quot;Gene_idGene&quot;  &quot;Relationship&quot; &quot;GoFunction&quot;  
##  [5] &quot;GoNum&quot;        &quot;TairKW&quot;       &quot;Aspect&quot;       &quot;GoSlim&quot;      
##  [9] &quot;EvidenceCode&quot; &quot;EvidenceDesc&quot; &quot;EvidenceWith&quot; &quot;Ref&quot;         
## [13] &quot;Database&quot;     &quot;Date&quot;         &quot;locus&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#allfeat</span>
<span class="kw">names</span>(allfeat)</code></pre></div>
<pre><code>## [1] &quot;begin&quot;      &quot;end&quot;        &quot;feature&quot;    &quot;order&quot;      &quot;transcript&quot;
## [6] &quot;locus&quot;      &quot;chrom&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#allmeth</span>
<span class="kw">names</span>(allmeth)</code></pre></div>
<pre><code>## [1] &quot;begin&quot;      &quot;end&quot;        &quot;feature&quot;    &quot;order&quot;      &quot;transcript&quot;
## [6] &quot;locus&quot;      &quot;chrom&quot;      &quot;methsites&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#SalkPos</span>
<span class="kw">names</span>(SalkPos)</code></pre></div>
<pre><code>## [1] &quot;fullSalk&quot;  &quot;chrom.pos&quot; &quot;e&quot;         &quot;index&quot;     &quot;locus&quot;     &quot;SALK&quot;     
## [7] &quot;chrom&quot;     &quot;pos&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#SalkInsert</span>
<span class="kw">names</span>(SalkInsert)</code></pre></div>
<pre><code>##  [1] &quot;begin&quot;      &quot;end&quot;        &quot;feature&quot;    &quot;order&quot;      &quot;transcript&quot;
##  [6] &quot;locus&quot;      &quot;chrom&quot;      &quot;SALK_Line&quot;  &quot;pos&quot;        &quot;accession&quot;</code></pre>
</div>
<div id="experiments-and-meta-experiments" class="section level1">
<h1>Experiments and Meta Experiments</h1>
<p>The experiment table is sort of “subexperiment-oriented”. the database now provides a way to lump all the data associated with experiments 1a1, 1a2, 1a3, etc into a meta.experiment called “1”. This provides a quick way to do subsetting of the huge data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(phenolong[,<span class="kw">c</span>(<span class="st">&quot;experiment&quot;</span>,<span class="st">&quot;meta.experiment&quot;</span>)])</code></pre></div>
<pre><code>##                 experiment meta.experiment
## 1               cofc-first           first
## 3400           cofc-second          second
## 5891                   1a1               1
## 25076                  1a2               1
## 55448                 3pt1               3
## 69950               Phyt2A            phyt
## 91959               Phyt2B            phyt
## 114632                3pt2               3
## 128200                3pt4               3
## 140346                 1a4               1
## 146540                3pt5               3
## 157593            VT_Expt3               3
## 163903           CofC-SF12            farm
## 164671           CofC-SF13            farm
## 165439           CofC-SF14            farm
## 166207           CofC-SF15            farm
## 166975           CofC-SF16            farm
## 168517          TCTC_Expt3               3
## 180211      Benedict_Expt3               3
## 192472           CofC-SF10            farm
## 193075           CofC-SF11            farm
## 193813           CofC-SF07            farm
## 194773           CofC-SF08            farm
## 195406           CofC-SF09            farm
## 196381           CofC_SF25            farm
## 197149           CofC_SF26            farm
## 197917           CofC_SF27            farm
## 198685               3Pt10               3
## 211443                3Pt9               3
## 222937             GH-Su16              GH
## 237547           CofC_SF28            farm
## 239083           VT_Expt_5            farm
## 244075              3pt2OB            farm
## 255777              3pt3OB               3
## 265892            UPEI_GC1           other
## 278003           Autoclave                
## 278579         BC_Expt3pt7            farm
## 292099         BC_Expt3pt6            farm
## 304971            BC_Expt2               2
## 326242 GH_StandardEnv_2016     StandardEnv
## 343438          CofC_Expt2               2
## 371121                 1a3               1
## 395227            TE_Expt2              TE
## 421115             TE_Expt              TE
## 433995             Chrome4           Chrom
## 459915           CofC_SF29            farm
## 460686           CofC_SF30            farm
## 461454           CofC_SF31            farm
## 462222           CofC_SF34            farm
## 462993           CofC_SF35            farm
## 463761           CofC_SF36            farm
## 464532           CofC_SF37            farm
## 465303           CofC_SF38            farm
## 466077           CofC_SF39            farm
## 466845           CofC_SF40            farm
## 467613           CofC_SF41            farm
## 468381           CofC_SF42            farm
## 469155           CofC_SF43            farm
## 469923           CofC_SF44            farm
## 470691           CofC_SF45            farm
## 471459           CofC_SF46            farm
## 472230            GH_Expt2             GH2
## 497778               3Pt11               3
## 510029               3Pt12               3</code></pre>
<p>So, to subset the data to exclude farms one could do a couple of easy lines of code. I’m using dplyr throughout on this document, btw.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">unique</span>(phenolong<span class="op">$</span>experiment)</code></pre></div>
<pre><code>##  [1] &quot;cofc-first&quot;          &quot;cofc-second&quot;         &quot;1a1&quot;                
##  [4] &quot;1a2&quot;                 &quot;3pt1&quot;                &quot;Phyt2A&quot;             
##  [7] &quot;Phyt2B&quot;              &quot;3pt2&quot;                &quot;3pt4&quot;               
## [10] &quot;1a4&quot;                 &quot;3pt5&quot;                &quot;VT_Expt3&quot;           
## [13] &quot;CofC-SF12&quot;           &quot;CofC-SF13&quot;           &quot;CofC-SF14&quot;          
## [16] &quot;CofC-SF15&quot;           &quot;CofC-SF16&quot;           &quot;TCTC_Expt3&quot;         
## [19] &quot;Benedict_Expt3&quot;      &quot;CofC-SF10&quot;           &quot;CofC-SF11&quot;          
## [22] &quot;CofC-SF07&quot;           &quot;CofC-SF08&quot;           &quot;CofC-SF09&quot;          
## [25] &quot;CofC_SF25&quot;           &quot;CofC_SF26&quot;           &quot;CofC_SF27&quot;          
## [28] &quot;3Pt10&quot;               &quot;3Pt9&quot;                &quot;GH-Su16&quot;            
## [31] &quot;CofC_SF28&quot;           &quot;VT_Expt_5&quot;           &quot;3pt2OB&quot;             
## [34] &quot;3pt3OB&quot;              &quot;UPEI_GC1&quot;            &quot;Autoclave&quot;          
## [37] &quot;BC_Expt3pt7&quot;         &quot;BC_Expt3pt6&quot;         &quot;BC_Expt2&quot;           
## [40] &quot;GH_StandardEnv_2016&quot; &quot;CofC_Expt2&quot;          &quot;1a3&quot;                
## [43] &quot;TE_Expt2&quot;            &quot;TE_Expt&quot;             &quot;Chrome4&quot;            
## [46] &quot;CofC_SF29&quot;           &quot;CofC_SF30&quot;           &quot;CofC_SF31&quot;          
## [49] &quot;CofC_SF34&quot;           &quot;CofC_SF35&quot;           &quot;CofC_SF36&quot;          
## [52] &quot;CofC_SF37&quot;           &quot;CofC_SF38&quot;           &quot;CofC_SF39&quot;          
## [55] &quot;CofC_SF40&quot;           &quot;CofC_SF41&quot;           &quot;CofC_SF42&quot;          
## [58] &quot;CofC_SF43&quot;           &quot;CofC_SF44&quot;           &quot;CofC_SF45&quot;          
## [61] &quot;CofC_SF46&quot;           &quot;GH_Expt2&quot;            &quot;3Pt11&quot;              
## [64] &quot;3Pt12&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nofarm.long &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(meta.experiment<span class="op">!=</span><span class="st">'farm'</span>)
<span class="kw">unique</span>(nofarm.long<span class="op">$</span>experiment)</code></pre></div>
<pre><code>##  [1] &quot;cofc-first&quot;          &quot;cofc-second&quot;         &quot;1a1&quot;                
##  [4] &quot;1a2&quot;                 &quot;3pt1&quot;                &quot;Phyt2A&quot;             
##  [7] &quot;Phyt2B&quot;              &quot;3pt2&quot;                &quot;3pt4&quot;               
## [10] &quot;1a4&quot;                 &quot;3pt5&quot;                &quot;VT_Expt3&quot;           
## [13] &quot;TCTC_Expt3&quot;          &quot;Benedict_Expt3&quot;      &quot;3Pt10&quot;              
## [16] &quot;3Pt9&quot;                &quot;GH-Su16&quot;             &quot;3pt3OB&quot;             
## [19] &quot;UPEI_GC1&quot;            &quot;Autoclave&quot;           &quot;BC_Expt2&quot;           
## [22] &quot;GH_StandardEnv_2016&quot; &quot;CofC_Expt2&quot;          &quot;1a3&quot;                
## [25] &quot;TE_Expt2&quot;            &quot;TE_Expt&quot;             &quot;Chrome4&quot;            
## [28] &quot;GH_Expt2&quot;            &quot;3Pt11&quot;               &quot;3Pt12&quot;</code></pre>
<p>Or maybe you only want to look at the distribution of individual fruitnums for experiment1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp1 &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(meta.experiment<span class="op">==</span><span class="st">&quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable<span class="op">==</span><span class="st">&quot;fruitnum&quot;</span>) 
<span class="kw">library</span>(ggplot2) <span class="co">#might as well use ggplot to start with</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>exp1, <span class="kw">aes</span>(value, <span class="dt">fill=</span>experiment)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">50</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAHlBMVEUAAAAAv8QzMzNNTU18rgDHfP/r6+vy8vL4dm3///8RzeqeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFYElEQVR4nO3diZaaSgAAUfJMXsb//+GMLLI1FEvjNN1V57iiRm4aJBK1etpq1U8/gdQTCBIIEggSCBIIOgP0f1d/btelg3f7vhRt9jmBIIEggSCBIIEggSCBIIEggSCBoPNAX00CzRMIEggSCBIIEggSCBIIEggSCBIIEmhTLVCE55JkjiBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIGgF6PF4LJ7UFQ70aA7Bk6bCgV4JtA70eAq0BvTojgJA/33X3KoFuvZpxmvvq9LaSvp9nNMIWgeaT11fST/zA1ovd6Dqu9dxffZ73uqL3dX15dcM16fP2aTqfWkj0KPZ5rnRdlA3380s9xcHh9H1gZvMH3MRiEsPqDuqOqNGIXBaLU/KGajqlpHRUXd1CCgwKWeg8bnpXC+NoMBNcwcKLGICPXklHQAKTMoYCF/mZ0DTSc8dL/NbgX43JQEUb96iPIhAkEBQ6kBREggSCBIIEggSCBIIygroK9TfE3P4FAgTCBIIEggSCCoKaDyz22a9IKDxTsH5LsLigbqZ7WgECgON3oIWKLwOEggWMYFcxAS6DKh+FXsrCRRvS7qaXoEJBBUFVHXtuG9RQEfWRoUBHa0FOv04EboYaPcyltwI+hvslM9wEds9mJIDuqKs1kG/Q6Wykm4W+JyB9gsVBrR/Q6gwoP0JBBUGVMAiNpq3jbN65v9N3wxosttn48zObpP/COqhBAoB9UPn2CKWPdBIag/QyfeD7gM0/PzKHqD93ROoxdk64wJtB4qxiH31TqkCtbt9ts7s9P2gkyvptIGOFG2vhkDzSgNyEQtV1Er6SJFf5gUalhzQtbt9wh8bXys5oCuKvJJuL/wQ0K9Qab3MCzSsNCAXsVCRt4OyBtqdQNDtgGLs9tnTzYAi7fbJFyjSbp+jQKNSBur/p/3pRaz9Mlf4osm7AQ3OnBtBncgTvqr0dkD9xszZRSxPoMFeDYEEOgDUfdonwnbQtm8kDwFt+ZMviICOVNQIEugngHLaDooNRAkEBYDaJyVQXXJAF+/22V1yQFeUFdCfUI6gPoEEEkgggfpuBzSZ2c/u9kkfaPoG0If3i6UPNNntUzmCwkDV+yDQ4jqo2v5phAKBql1fQVUeULt47f+sRllAm+e9PKD3l7wJNAM6kkCQQJBAkECQQFBWQO72AaArEgiKBvRrmEB1AkECQQJBAkECQQJBAm0qBBThiaWSIwgSCBIIEggSCBIIugaovU4ggVYTCBIIWgYarKsFEmgxgaARULMbU6BhAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQGgPyMngQAIfuknS6DFb+IMAQ0GUilAy9/lKlBdAKhVEKhOICjwhduZd34EHR8KWY+gVwLNE4iabwcJtJhAkECQQJBAkECQQFtb+0fHyrSDd1udFj2BIIEggaAoQDknECQQFANo+C/8yXWBXyWrLy9OW7nf+kNeVQSg0XtE4+tCv2v3Ov+Y3YTvt/6Ql3URUHt9eG4ez1WghWnZAS0irAOtjK7lSRd2GVDgFyT7KSsIpSxij+Gk0IwWvg5aW5fUCTScNLtFWSMotEnSjhK3g/JPIEggSCBIIEgg6MeA7vI3IxAkEPSx59n/tlfzw2fV/Kok+zhQ1R3mVyXZ50dQezoE+ugT2dnnntdbolmgRiMo4WXs40CDFdBoBKXa54H68wJN/qiqO+4WsckhyT4O1PxIZdW9vPsyf/cEggSCBIIEggSCBIIEggSCBIIEgv4Br5LWv141gfQAAAAASUVORK5CYII=" /><!-- --></p>
<p>Here’s the same exercise but getting averages for every replicate within a growth chamber within an experiment</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp1mn &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(meta.experiment<span class="op">==</span><span class="st">&quot;1&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(variable<span class="op">==</span><span class="st">&quot;fruitnum&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(experiment,accession) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">value=</span><span class="kw">mean</span>(value,<span class="dt">na.rm=</span>T))
<span class="kw">ggplot</span>(<span class="dt">data=</span>exp1mn, <span class="kw">aes</span>(value, <span class="dt">fill=</span>experiment)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">50</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>I’ve done all of the above with the long format, but similar approaches could be used with the wide format in phenowide</p>
<p>For example, it is arguably easier to compare phenotypes when they are in the wide format</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp1 &lt;-<span class="st"> </span>phenowide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(meta.experiment<span class="op">==</span><span class="st">&quot;1&quot;</span>)
<span class="kw">ggplot</span>(<span class="dt">data=</span>exp1,<span class="kw">aes</span>(<span class="dt">x=</span>days.to.bolt,<span class="dt">y=</span>fruitnum))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<pre><code>## Warning: Removed 1123 rows containing missing values (geom_point).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --> might be nice to see whats with that point at 765 fruits</p>
</div>
<div id="correcting-phenotypes-for-within-growth-chamber-variance-phytometers-or-col" class="section level1">
<h1>Correcting phenotypes for within Growth Chamber variance, phytometers or col</h1>
<p>Everything so far has been performed on uncorrected phenotypes.</p>
<p>We can correct phenotypes based on the Treatment, Experiment, and Facility combinations</p>
<p>Here’s an example scaling data by the amount of variation in each experiment/facility combination.</p>
<p>I’m using ‘phenos’ as the name of a vector to capture the names of a couple of phenotypes. This could be a single phenotype or many.</p>
<p>The first real line gives a good intuition into how one can filter on just a few variables in the long format and then “spread” them so that variables can be compared to one another.</p>
<p>The rest of the lines of code create dataframes that have the trait variables adjusted by means of columbia or scaled by sd or both.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phenos =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>)

plotraw =<span class="st"> </span>phenolong <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">%in%</span><span class="st"> </span>phenos) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>()

plotscale &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(variable <span class="op">%in%</span><span class="st"> </span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">scalePhenos</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>()

plotadj &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(variable <span class="op">%in%</span><span class="st"> </span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">colcorrect</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spread</span>()

plot.all &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(variable <span class="op">%in%</span><span class="st"> </span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">colcorrect</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">scalePhenos</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>()


<span class="kw">plot</span>(fruitnum<span class="op">~</span>days.to.bolt,<span class="dt">data=</span>plotraw,<span class="dt">main=</span><span class="st">&quot;unadjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum<span class="op">~</span>days.to.bolt,<span class="dt">data=</span>plotscale,<span class="dt">main=</span><span class="st">&quot;scaled by std. dev.&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum<span class="op">~</span>days.to.bolt,<span class="dt">data=</span>plotadj,<span class="dt">main=</span><span class="st">&quot;adjusted by columbia mean.&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum<span class="op">~</span>days.to.bolt,<span class="dt">data=</span>plot.all,<span class="dt">main=</span><span class="st">&quot;scaled and adjusted by columbia mean&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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+XwM0J+z5HN5qQLxCPRFQPGB13HIu5kHVtq9Rg8BqvCctnfE2L5dvycBEdCYJwER0JgnARHQmCcBEdBPiYCACAiIgIAICIiAgAgIiICACAiIgIAICIiAgOwBnV/tNXx1IJvn25UNSw1r2uds25vUOdpfPbuyK9wF2rfb9smtB8itBMiJj6uvfXlPdn+poato3+7bq72QvhGo0A4BKiRcElCnd75dRQ/K7VwR0JB5sl3NAZY638OAQg/vBCRPkS8CSjqyB2Ude6eyUrvisFZMuNI0P2+QBpZwkF4MUN+6vtwOXmrMKIkXq0AEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQM8DsnieYOJRvADQJSANaNKREFBr9lvl9j/Htj8lL57jCY+q7JvqCb3wvJ87ntfqfawWljjDtCW5BHMCEk+piRcBWfzuR3tQ9Niciw5WAlKhmqNsN63IZ6QBOQnIRWG/Dsidg1F4XE6F/TggQUqccTzFUoDOWYljkI9mMYHmOkWpjZ+ZxbxaB4njDquagO5Y5vzxTKyDopHdrsQZpv1arBy/XEWLleMXq2jOSTKmBUtaSwQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAT0D0z2KQVCJIzwAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Here is a version with the adjustment done by the mean of the phytometers in each chamber/time combo rather than the mean of columbia alone.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phenos =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>)

plotadj &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(variable <span class="op">%in%</span><span class="st"> </span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">phytcorrect</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>), <span class="dt">pheno=</span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spread</span>()

plot.all &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(variable <span class="op">%in%</span><span class="st"> </span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">phytcorrect</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>), <span class="dt">pheno=</span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">scalePhenos</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>()


<span class="kw">plot</span>(fruitnum<span class="op">~</span>days.to.bolt,<span class="dt">data=</span>plotraw,<span class="dt">main=</span><span class="st">&quot;unadjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum<span class="op">~</span>days.to.bolt,<span class="dt">data=</span>plotscale,<span class="dt">main=</span><span class="st">&quot;scaled by std. dev.&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum<span class="op">~</span>days.to.bolt,<span class="dt">data=</span>plotadj,<span class="dt">main=</span><span class="st">&quot;adjusted by columbia mean.&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum<span class="op">~</span>days.to.bolt,<span class="dt">data=</span>plot.all,<span class="dt">main=</span><span class="st">&quot;scaled and adjusted by columbia mean&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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gFq8TqzgZhZ/gy0lICACAiIgIAICIiAgAgIiICACAlq6N/iCCAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIaMlXocdLz5cHonS5WNVfrboQUX843SWafZpvn5PvmhvLnefq5QfcDir+JZLe4tUzQ4DcVoCcuF5DxetnQC+qRDQW1rouNjYCVYoBQLXq9gQ05r1cDGdQsbotAc24zxZraGC1/z0NKOT4GCDZRz4JKOuTGVT0OTiV1YrVhpmWKW6TaX7ZII3H4fogvRugoYV9vRjaaqyIiJtVIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiCg5wFZfF2+sBUvAJQY5AEtagkB9dZ+q5w7/x+6E//mwavn8Y5D9YBeeNrPnU9rDT5Ui0Nc4bSncgnmAiSeURNvArL4049mUPTYnIsaKwEpU81RllsW5DPSgJwE5CKzvw7IXYNReFpOmf1xQIKU6HHsYjlA16zEMchHs5hAk05R6uDPzGJerYNEu8OqJqA7lzk/PDProGhktwtxhdNxbRaO3y6izcLxm0W0ppPMacOQ9hIBAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEB/QMEuSl8+hf+ywAAAABJRU5ErkJggg==" /><!-- --></p>
<p>You could easily make ‘phenos’ longer and look at multivariable relationships:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phenos =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>,<span class="st">&quot;diameter.at.bolt&quot;</span>)

plot.all &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(variable <span class="op">%in%</span><span class="st"> </span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">phytcorrect</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>), <span class="dt">pheno=</span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">scalePhenos</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>() 

<span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(plot.all,<span class="dt">columns=</span>phenos)</code></pre></div>
<pre><code>## Warning: Removed 848 rows containing non-finite values (stat_density).</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method =
## &quot;pearson&quot;, : Removed 3713 rows containing missing values</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method =
## &quot;pearson&quot;, : Removed 2348 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 3713 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 2868 rows containing non-finite values (stat_density).</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method =
## &quot;pearson&quot;, : Removed 3221 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 2348 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 3221 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 1831 rows containing non-finite values (stat_density).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Of course, these are all based on individual data points. It might make sense to take the means of accessions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phenos =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>,<span class="st">&quot;diameter.at.bolt&quot;</span>)

plot.all &lt;-<span class="st"> </span>phenolong <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(variable <span class="op">%in%</span><span class="st"> </span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">phytcorrect</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>), <span class="dt">pheno=</span>phenos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">scalePhenos</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(facility, experiment,variable,accession) <span class="op">%&gt;%</span><span class="st">    </span>##group the data before
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">value=</span><span class="kw">mean</span>(value,<span class="dt">na.rm=</span>T)) <span class="op">%&gt;%</span><span class="st">                 </span>##taking the mean
<span class="st">  </span><span class="kw">spread</span>() 

<span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(plot.all,<span class="dt">columns=</span>phenos)</code></pre></div>
<pre><code>## Warning: Removed 294 rows containing non-finite values (stat_density).</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method =
## &quot;pearson&quot;, : Removed 1285 rows containing missing values</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method =
## &quot;pearson&quot;, : Removed 417 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 1285 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 991 rows containing non-finite values (stat_density).</code></pre>
<pre><code>## Warning in (function (data, mapping, alignPercent = 0.6, method =
## &quot;pearson&quot;, : Removed 1261 rows containing missing values</code></pre>
<pre><code>## Warning: Removed 417 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 1261 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 393 rows containing non-finite values (stat_density).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now we’re talking.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
