<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="A Strand" />

<meta name="date" content="2016-06-15" />

<title>Getting going with unpak data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Getting going with unpak data</h1>
<h4 class="author"><em>A Strand</em></h4>
<h4 class="date"><em>2016-06-15</em></h4>



<p>The unpakathon package is primarily a datafreeze of the unpak database. It also provides some functions to help work with these data.</p>
<p>This vignette shows how to interact with these data, once the package is installed and loaded into the current R session</p>
<p>load the library</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(unpakathon)</code></pre></div>
<pre><code>## Loading required package: adjustPhenotypes</code></pre>
<pre><code>## Loading required package: dplyr</code></pre>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## Loading required package: knitr</code></pre>
<pre><code>## Loading required package: reshape</code></pre>
<pre><code>## 
## Attaching package: 'reshape'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     rename</code></pre>
<pre><code>## Loading required package: rmarkdown</code></pre>
<pre><code>## Loading required package: GGally</code></pre>
<pre><code>## 
## Attaching package: 'GGally'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     nasa</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<div id="how-do-i-know-how-fresh-the-data-are" class="section level1">
<h1>How do I know how fresh the data are?</h1>
<p>After loading the package up using ‘library()’, the date of the snapshot is available:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datestamp</code></pre></div>
<pre><code>##              snapshot.date
## 1 Thu Mar  3 22:26:41 2016</code></pre>
</div>
<div id="tables" class="section level1">
<h1>Tables</h1>
<p>There are several tables available, each with some sort of help description that you can access by typing ?<tbl> (e.g. ?phenolong or ?independent)</p>
<p>Here are the tables at the moment and a list of their current column names</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#phenolong: long format for all the phenotypic data</span>
<span class="kw">names</span>(phenolong)</code></pre></div>
<pre><code>## [1] &quot;plantID&quot;         &quot;accession&quot;       &quot;treatment&quot;       &quot;experiment&quot;     
## [5] &quot;meta.experiment&quot; &quot;facility&quot;        &quot;variable&quot;        &quot;value&quot;          
## [9] &quot;Gene_idGene&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#phenowide: wide (typical) format for phenotypic data in phenolong</span>
<span class="kw">names</span>(phenowide)</code></pre></div>
<pre><code>##  [1] &quot;plantID&quot;              &quot;accession&quot;            &quot;treatment&quot;           
##  [4] &quot;experiment&quot;           &quot;meta.experiment&quot;      &quot;facility&quot;            
##  [7] &quot;aborted.fruits&quot;       &quot;alive.at.harvest&quot;     &quot;avg.fruit.length&quot;    
## [10] &quot;basal.branch&quot;         &quot;basalfruit.length&quot;    &quot;biomass&quot;             
## [13] &quot;branch.basalbranch&quot;   &quot;days.to.bolt&quot;         &quot;diameter.at.bolt&quot;    
## [16] &quot;FruitLength1&quot;         &quot;FruitLength2&quot;         &quot;FruitLength3&quot;        
## [19] &quot;FruitLength4&quot;         &quot;FruitLength5&quot;         &quot;FruitLength6&quot;        
## [22] &quot;FruitLength7&quot;         &quot;FruitLength8&quot;         &quot;fruitnum&quot;            
## [25] &quot;germinants.14d&quot;       &quot;germinants.31d&quot;       &quot;germinants.41d&quot;      
## [28] &quot;germinants.7d&quot;        &quot;germinated&quot;           &quot;inflorescence.height&quot;
## [31] &quot;leaf.number&quot;          &quot;mainbranch&quot;           &quot;max.silique&quot;         
## [34] &quot;midfruit.length&quot;      &quot;seeds.sown&quot;           &quot;ttl.maininfl.branch&quot; 
## [37] &quot;upperfruit.length&quot;    &quot;Gene_idGene&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#independent: a table of indepenent data, mostly gene expression and protein expression </span>
<span class="co">#indexed by both SALK_Line and Gene</span>
<span class="kw">names</span>(independent)</code></pre></div>
<pre><code>##  [1] &quot;id&quot;                          &quot;Accession_idAccession&quot;      
##  [3] &quot;Gene_idGene&quot;                 &quot;ConservedGroup&quot;             
##  [5] &quot;ProteinLevel&quot;                &quot;InsertLocation&quot;             
##  [7] &quot;AverageExpress7DaySeedling&quot;  &quot;StdDevExpress7DaySeedling&quot;  
##  [9] &quot;AverageExpressRosetteLeaf2&quot;  &quot;StdDevRosetteLeaf2&quot;         
## [11] &quot;AverageExpressRosetteLeaf4&quot;  &quot;AverageExpressRosetteLeaf6&quot; 
## [13] &quot;AverageExpressFlowerStage9&quot;  &quot;AverageExpressFlowerStage12&quot;
## [15] &quot;AverageExpressFlowerStage15&quot; &quot;accession&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##tdna: tdna data we know what it is.  indexed by accession
<span class="kw">names</span>(tdna)</code></pre></div>
<pre><code>##  [1] &quot;Accession_idAccession&quot; &quot;Endolocus&quot;            
##  [3] &quot;EndoArea&quot;              &quot;TDNAArea&quot;             
##  [5] &quot;AreaRatio&quot;             &quot;RepsUsed&quot;             
##  [7] &quot;RepsFailed&quot;            &quot;RatioCat&quot;             
##  [9] &quot;TimeStamp&quot;             &quot;accession&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#geneont The tair10 gene ontology indexed by gene</span>
<span class="kw">names</span>(geneont)</code></pre></div>
<pre><code>##  [1] &quot;row_names&quot;    &quot;Gene_idGene&quot;  &quot;Relationship&quot; &quot;GoFunction&quot;  
##  [5] &quot;GoNum&quot;        &quot;TairKW&quot;       &quot;Aspect&quot;       &quot;GoSlim&quot;      
##  [9] &quot;EvidenceCode&quot; &quot;EvidenceDesc&quot; &quot;EvidenceWith&quot; &quot;Ref&quot;         
## [13] &quot;Database&quot;     &quot;Date&quot;</code></pre>
</div>
<div id="experiments-and-meta-experiments" class="section level1">
<h1>Experiments and Meta Experiments</h1>
<p>The experiment table is sort of “subexperiment-oriented”. the database now provides a way to lump all the data associated with experiments 1a1, 1a2, 1a3, etc into a meta.experiment called “1”. This provides a quick way to do subsetting of the huge data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(phenolong[,<span class="kw">c</span>(<span class="st">&quot;experiment&quot;</span>,<span class="st">&quot;meta.experiment&quot;</span>)])</code></pre></div>
<pre><code>##            experiment meta.experiment
## 1          cofc-first           first
## 3400      cofc-second          second
## 5891              1a1               1
## 25076             1a2               1
## 55448            3pt1               3
## 69950          Phyt2A            phyt
## 91959          Phyt2B            phyt
## 114632           3pt2               3
## 128200            1a3               1
## 152306           3pt4               3
## 164452            1a4               1
## 170646           3pt5               3
## 181699       VT_Expt3               3
## 188009      CofC-SF12            farm
## 188777      CofC-SF13            farm
## 189545      CofC-SF14            farm
## 190313      CofC-SF15            farm
## 191081      CofC-SF16            farm
## 192617     TCTC_Expt3               3
## 204311 Benedict_Expt3               3
## 216572      CofC-SF10            farm
## 217175      CofC-SF11            farm
## 217913      CofC-SF07            farm
## 218873       TP1EXPT2               2</code></pre>
<p>So, to subset the data to exclude farms one could do a couple of easy lines of code. I’m using dplyr throughout on this document, btw.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">unique</span>(phenolong$experiment)</code></pre></div>
<pre><code>##  [1] &quot;cofc-first&quot;     &quot;cofc-second&quot;    &quot;1a1&quot;            &quot;1a2&quot;           
##  [5] &quot;3pt1&quot;           &quot;Phyt2A&quot;         &quot;Phyt2B&quot;         &quot;3pt2&quot;          
##  [9] &quot;1a3&quot;            &quot;3pt4&quot;           &quot;1a4&quot;            &quot;3pt5&quot;          
## [13] &quot;VT_Expt3&quot;       &quot;CofC-SF12&quot;      &quot;CofC-SF13&quot;      &quot;CofC-SF14&quot;     
## [17] &quot;CofC-SF15&quot;      &quot;CofC-SF16&quot;      &quot;TCTC_Expt3&quot;     &quot;Benedict_Expt3&quot;
## [21] &quot;CofC-SF10&quot;      &quot;CofC-SF11&quot;      &quot;CofC-SF07&quot;      &quot;TP1EXPT2&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nofarm.long &lt;-<span class="st"> </span>phenolong %&gt;%<span class="st"> </span><span class="kw">filter</span>(meta.experiment!=<span class="st">'farm'</span>)
<span class="kw">unique</span>(nofarm.long$experiment)</code></pre></div>
<pre><code>##  [1] &quot;cofc-first&quot;     &quot;cofc-second&quot;    &quot;1a1&quot;            &quot;1a2&quot;           
##  [5] &quot;3pt1&quot;           &quot;Phyt2A&quot;         &quot;Phyt2B&quot;         &quot;3pt2&quot;          
##  [9] &quot;1a3&quot;            &quot;3pt4&quot;           &quot;1a4&quot;            &quot;3pt5&quot;          
## [13] &quot;VT_Expt3&quot;       &quot;TCTC_Expt3&quot;     &quot;Benedict_Expt3&quot; &quot;TP1EXPT2&quot;</code></pre>
<p>Or maybe you only want to look at the distribution of individual fruitnums for experiment1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp1 &lt;-<span class="st"> </span>phenolong %&gt;%<span class="st"> </span><span class="kw">filter</span>(meta.experiment==<span class="st">&quot;1&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">filter</span>(variable==<span class="st">&quot;fruitnum&quot;</span>) 
<span class="kw">library</span>(ggplot2) <span class="co">#might as well use ggplot to start with</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>exp1, <span class="kw">aes</span>(value, <span class="dt">fill=</span>experiment)) +<span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">50</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAHlBMVEUAAAAAv8QzMzNNTU18rgDHfP/r6+vy8vL4dm3///8RzeqeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFaUlEQVR4nO3diZaaSABAUTJ0JuP///BEFmUpeCwFllXvneMGauCGxZZurR62WvXpCUg9gSCBIIEggSCBoHNA//a9r119I9J8b04gSCBIIEggSCBIIEggSCBIIEggKALQrzaBAjUT/dMmUCCBIIEggSCBIIEggSCBIIEggSCBttQBnX+iJHMJggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSC1oHqul68eFY6UN2eghdNpQM9E2i9+iHQWnV/JlCw+nU+B/rn2XN0B3TtdJ7s+M4aN9KPLJagdaC1sYUArXccqG5f8yT+Oqj62/O8ufp3jpqb/eDm9nM2m8vHbFT1unUACEsCqJ/vdpbfNwen0fDAXVZmMQeg/qzqjVqFwGW1PCpnoKpfR0Zn/eAQUGBUzkDja9O5XlqCAnfNHSiwign04I10ACgwKmMg3M3PgKajHnnv5qPOUeSnEwgSCEoRKHICQQJBAkEZAP0X6s+p+RokECQQJBAkECQQlDnQePaOzGzWQOOjFWvHLpbLGqifvZ5GoDDQ6L2xvZUA9Loi0PIqJpCrmECXATV7sZfSzjIHOp9AkECQQFAVuLEdTSCoLKCqb/ujkwD6E+w8TaeyeGNzHVCUyUmvDDbSP6Eu2ovtXcdKA9r9lltxQHsfPQT63STQqNKAdguVBrT7hVDyQNPZOwm0u8SBJod9Ds1u1kDTwz6ngTJdxd6LTpxV7ODPYukCva7Eess1tyVo9Iv1eysBqMM5trkNrWICDTXGNCfeD0oXqDvss3PeQkC7Sx7ofLGBfr+dcgQ6v4rlDdT/IdrmRxcHFBi2mkBQcUBfuYrdeNgnwkb6V9udQNcWezf/AaBfoZJ9HZQ5UPNTy7etYjcCRdhIZw4UGLaaQFBxQNmtYrEP+5x5HTSavjSA0jrskyBQ9MM+u/sOoPdv2n/0yGq6QIMrLkFLq5hAvIpdspHuPu12yydxlgjUizy2fJZrukD9X/tc8esv3w50PoEuA5p+4PZo+mJN3pZSBXrmEiSQQBGAEn8ddOdhn70lAXRtGQD9DuUS9E4ggQQSSKBwQ6ARUypAk9n76HvSCQJN3wD67Jv2CQJNDvtULkFhoOp1EmhxG1Qd/WuEIoCqEx9BFQGo+ziRdIG61etjf6vxJUAH57YEoNeHvAk0AzqfQJBAkECQQJBAUAZAyR/2+TTQtQkECQQJBAkECQQJBAkECQQJBAkECQQJBJ0DagoBnX/WVHIJggSCBIIEggSCBIIuAno7CSTQSkOgNoFGCQQJBM2BfqY7M4EEWkkgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBoDtQlUJtAkECQQJBAEAG9mIoCmn4SZwhotLcvDGj2Wa4CjRMI2g8UdYsdde43dBzo9YnkeRdhCYq07mS3BD0TKJBA1PR1kEDLCQQJBAkECQQJBAm0teWfOe4ac1UCQQJBAkECQZGA8i0K0ODH18mg+TduPfovLQuMWX7Q2tNdWwyg4Rsg40GB72x7zt7sDvSgtae7uIuAusFhhjWg8KgsgZYZVsYsjlocc3WXAQW+HbEfvqxQ0CpWD8cM7lA/VoAe5QAtbk7qJoGWt7eD+xcDFHhd0i0nvg7KP4EggSCBIIEggaAPAX3P/4tAkEDQTVP6/qa49mv0qvmgRLsZqOpP80GJdvcS1F0OgW6cjAPdNWUviXaFGi1BSa9jNwMNNkCjJSjd7gZ6Xxdo8g9V/Xm/ik1OiXYzUPuVp1W/e3c3//0JBAkECQQJBAkECQQJBAkECQQJBP0PgOHoIx837cwAAAAASUVORK5CYII=" alt /><!-- --></p>
<p>Here’s the same exercise but getting averages for every replicate within a growth chamber within an experiment</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp1mn &lt;-<span class="st"> </span>phenolong %&gt;%<span class="st"> </span><span class="kw">filter</span>(meta.experiment==<span class="st">&quot;1&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(variable==<span class="st">&quot;fruitnum&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(experiment,accession) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">value=</span><span class="kw">mean</span>(value,<span class="dt">na.rm=</span>T))
<span class="kw">ggplot</span>(<span class="dt">data=</span>exp1mn, <span class="kw">aes</span>(value, <span class="dt">fill=</span>experiment)) +<span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">50</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>I’ve done all of the above with the long format, but similar approaches could be used with the wide format in phenowide</p>
<p>For example, it is arguably easier to compare phenotypes when they are in the wide format</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp1 &lt;-<span class="st"> </span>phenowide %&gt;%<span class="st"> </span><span class="kw">filter</span>(meta.experiment==<span class="st">&quot;1&quot;</span>)
<span class="kw">ggplot</span>(<span class="dt">data=</span>exp1,<span class="kw">aes</span>(<span class="dt">x=</span>days.to.bolt,<span class="dt">y=</span>fruitnum))+<span class="kw">geom_point</span>()</code></pre></div>
<pre><code>## Warning: Removed 1123 rows containing missing values (geom_point).</code></pre>
<p><img src="data:image/png;base64,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" alt /><!-- --> might be nice to see whats with that point at 765 fruits</p>
</div>
<div id="merging-with-other-data" class="section level1">
<h1>Merging with other data</h1>
<p>The information in the other tables can be compared to phenotypes through merging.</p>
<p>Say you wanted to look at how insertion location might influence phenotype. You could merge in the ‘independent’ table and look at the result</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">newdf &lt;-<span class="st"> </span><span class="kw">left_join</span>(phenolong,independent) %&gt;%<span class="st"> </span><span class="kw">filter</span>(variable==<span class="st">&quot;fruitnum&quot;</span>)</code></pre></div>
<pre><code>## Joining by: c(&quot;accession&quot;, &quot;Gene_idGene&quot;)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>newdf, <span class="kw">aes</span>(<span class="dt">x=</span>InsertLocation, <span class="dt">y=</span><span class="kw">log</span>(value<span class="dv">+1</span>)))+<span class="kw">geom_boxplot</span>()</code></pre></div>
<pre><code>## Warning: Removed 5831 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>or you could look at expression at flower stage 9</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>newdf, <span class="kw">aes</span>(<span class="dt">x=</span>AverageExpressFlowerStage9, <span class="dt">y=</span><span class="kw">log</span>(value<span class="dv">+1</span>)))+<span class="kw">geom_point</span>()</code></pre></div>
<pre><code>## Warning: Removed 8596 rows containing missing values (geom_point).</code></pre>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
</div>
<div id="correcting-phenotypes-for-within-growth-chamber-variance-phytometers-or-col" class="section level1">
<h1>Correcting phenotypes for within Growth Chamber variance, phytometers or col</h1>
<p>Everything so far has been performed on uncorrected phenotypes.</p>
<p>We can correct phenotypes based on the Treatment, Experiment, and Facility combinations</p>
<p>Here’s an example scaling data by the amount of variation in each experiment/facility combination</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(reshape)
plotdf =<span class="st"> </span>phenolong %&gt;%<span class="st"> </span><span class="kw">filter</span>(variable %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>)) %&gt;%<span class="st"> </span><span class="kw">cast</span>(<span class="dt">fun.aggregate=</span>mean)

plotadj &lt;-<span class="st"> </span>phenolong %&gt;%
<span class="st">  </span><span class="kw">filter</span>(variable %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">scalePhenos</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>,<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>),<span class="dt">lineid=</span><span class="st">&quot;accession&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">cast</span>(<span class="dt">fun.aggregate=</span>mean)

<span class="kw">plot</span>(fruitnum~days.to.bolt,<span class="dt">data=</span>plotdf,<span class="dt">main=</span><span class="st">&quot;unadjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHl0lEQVR4nO2dAXKkIBBF2/tfeqs2Ct2IfMBG0PmvajPZGWjwDTQ6kkQ2UkRmd2B1KAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFARYV5CI7F866jl2wzOYK0jQ1UsUpF9veL63G57BXEEH+llBfwcQxoccByThu7/n4ghSNfZiEh+3LVfPsbuewepaNILCcYo94qjBCgovWVFpPcfuegara9EKik9cvpaMOZueMk9/SlB4Yn8pd+RnK0mcP726nmN3PYPVtXghyE6ra0FqTsZaPyAoJtiSoJPHnxFUSi7pTCw9+xVBkrUi9gk5v/YjSfo0S/ZnL6aN/b/KQbln3i/olG1sDsrlo5O8GGfTY0aV8+utZzB/nI+2pweT2wdQUBH3hNLTh8ntF1nAz9qCVoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCCAsyB5DbME+UaT44s7nxAUttp5Bj1iuxecEE6SxxGx/QpOCEdBlcEo6CoYcxCKxlUMhWs5Y2mL7F5wSrhxUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEKBdUOstWRul+Y7ubJoFOR0ZBXm1OxsKAnTkoGfbnc3DSbq93dlwigEoCEBBACZpQPsIYpK+WXBKOBvb81Lmg4J8Nwt9T5DzdrNBOQgWGSjIt4XeEVSsF38j6P12m1lEUKmiVJSiIFDquzmoouKTgv5yncl4i6xixQz8WA4yv0Y5PjnzPKjuRPqhVcz87nXuk76KIuFxABRU1URLwZVOFI8Zts8xl5i5JloK1lR4LEmbX+Y/5nbbCEEPLvPRTLqUefFyQeaHg//+7xQ4NNBa8J4gx1vPe5TwZyK2MYmoI0lXlH0gB9m/ICJbmGl3A6fttBZc5OMO4+dIRdsKU+zpdgv1zV+rOWac9zDqzkE3++AiaEsFDVjMRgoaOsW2LaadkyBHQ42Cmlah0TkoP3ScLzuGLPOCPXqsYpmxE5qcJ6ih6Nhrsbh+KUMSzzCcUvWQVaziXfTofDp+1Jj1S9VtgvRbVi59rDK32y02cpWkHT+XHnYeFNKlT7hsC2c3ybu3siDw/jnloJwiFf16jahOUYMuNfzavQyQPwuKp5ClVhpSVO8I8jjRuxfgaviYHJR/J1tSVPcUmzSCwiFnRpCaXmpAhVPKc+MfFBTmRu5MOs3UZubp8fJdQXFuXIjYx1HGjzb0YUHH+fPVhWppTOkbM/rBqaPpKtZ0YDfatbXCreYaI2qghbpHnK3Sz8s+MDPz6FLSeXjtlZNAvh11PDntD2OGyPWlxmV6GtnRVQTtX5ty0GmKjejoaQm4h8MIqpbz8Ai601pHu7ZWjyBpWbT6O7pckm419MgIkruikje1v3q9maCzr+sPC2pv19ZKD73SkKi6ozqqr4/7h0B7u7aWbr9Kj5ylDuroKsv8HfYQRyDfjq6VpHsFhYft45canYLsZ0NjPzC7yRRBYXY1dOLnBIla7ynowhIFlfUIc1DJjzpzdO3oVwT9WTpcOXZ0BUFefigI29k+OcX8BO3hPDv6HUHy3RPF+2L2ryGYY0c/IUhtIKr97OPHBJ19uXV0gKC/PrZUchBi5eAuTBTUsNYelQaAujBPUM/NmBGGgqirjlYfkSttl9Sh1mBDStXxLQVdqdq/DBIUW7oMt5wgdedf79Sq7lvTcdjHbLh7OWiAK32NFt+9EYIk++2pTPsqZm7MDhC092amIH2E7edByWmMn5l1BPWE07VGYqbYAjmoh/RNHyEoWpq8inUhOrCzH7u94fjuVRerW5K3fA0ZP+0d9Rb0GiYJ6o/vXtDpyCjomTD341PQ0wUpyCvgI2Hux6egpwtSkFfAR8Lcj/+rgl4PBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYChgsLtA3gXoeo2Q124eHetITQMNwZRj8WG6m7l1YUTW6bpLmGh0SHMECQvEiTmEc4K1JWqcBK1bHE/x42jHCpIxPa23AkoqC7cmwRteoS7jKCKcC8SdDTgJKgy3BsE6c0BFIQboKBSaJs5CkXrFjEc7mXLfF0nq46iMtyLBDWc7tdealSUTsusfKnxBSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA+YLae3CuMXyPykyqdnWAGne3cLS0/jgUVGp9/21i+x56tbUnblrZvzW7+tK9LWK3/bl2cUTQlsa1GLtxTlQpM0bi79iS5N+gPs4i2T8oycFqQaboeQPiTwgSLUiSYr8uSEIyijvoTLEfF6RMqRnHKZYTpH4cg4LsKnb6SZVTxo4req7IFwWZ8yB13Jv9yR5zHvTfZ+Y8KMnsfl0cEbSfxbqzLdejxbqzLdajMZPkHgt2aS0oCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8AFqwtpf8BpogAAAAASUVORK5CYII=" alt /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum~days.to.bolt,<span class="dt">data=</span>plotadj,<span class="dt">main=</span><span class="st">&quot;adjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>Here’s an example correcting for phytometers</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotdf =<span class="st"> </span>phenolong %&gt;%<span class="st"> </span><span class="kw">filter</span>(variable %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>)) %&gt;%<span class="st"> </span><span class="kw">cast</span>(<span class="dt">fun.aggregate=</span>mean)

plotadj &lt;-<span class="st"> </span><span class="kw">phytcorrect</span>(phenolong,<span class="dt">pheno=</span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>),<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>,<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>),<span class="dt">lineid=</span><span class="st">&quot;accession&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">cast</span>(<span class="dt">fun.aggregate=</span>mean)</code></pre></div>
<pre><code>## Joining by: c(&quot;treatment&quot;, &quot;experiment&quot;, &quot;facility&quot;, &quot;variable&quot;)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum~days.to.bolt,<span class="dt">data=</span>plotdf,<span class="dt">main=</span><span class="st">&quot;unadjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum~days.to.bolt,<span class="dt">data=</span>plotadj,<span class="dt">main=</span><span class="st">&quot;adjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG2ElEQVR4nO2djZKrKhAGx/d/6a3aKAKaNCgjqF9X3T35GQbs4EiMybVJ/MR6D2B0JAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIGAwQWY2/znQzoWbCfr2lATFz1c83mBETnkPQhv6OkFmYdP+b60z6PP4/KzNcRbi99r5jNApb2Hv6RavGlJB4alUVN7OZ4hOeQt7TyQs8yIXtLm59/AzBf2PYH/Lt1bC82tw2s5neE55S7tPdqvvgpadKN3lni8oK8xfBG08vkbQr+KSCEqf2u5zjxZkqSbLLL26SIdj93I7FRTdj2rQ3iNPFRRqkEW340KTyFtbTPGcieJchuiU9wx+W3uAgYYSkKCfeBaUAww0lJmx/AwoaDAkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIKAxoLsNvQS1DCVLX88uL+gcMlds4xp+uaBV6ez7N/GSFBh+naBV6eTIMqkGkSpdBSjXDXLlerkzQO7pPNDggAJAiQIuFhQ/XvA3mgGARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEAfWC2rwdf66gsgbo8N2C1t9bOd9vbzwE2e7Ng/325kANqsn5SkFYpN8tSDUIAnUUg8BGW/ZcQa0+/2mS5QLqZ1DRSvrFu1hR7JuLdF3oCw/zdaF5qxd89FywhZpB1E41CBvqKHZ2CyWoVb+98RT0zl2s4jD9TkEloQXftnq3oIImDxZUsI8tX59o0W9v3E6YQejbBf0rkiBoIUFX9NsbnXIFnE65tuu3Ny6nXK9P58fhGqQZ9CVQgn4GNjun/FRBOsyfD+ySzg8JAuoEmWkddDqwSzo/JAi4+K3GCz56rm13tt/ihE7W7/+52MeM20/A3F5Q8n/kdTB0V0FLJctqmgQtzRM50b1zafd6qg0c4s3qPABLiXexZrbuuQ7K5010bwmYGlWke76bX6aLbSZRUqxbGLqloI8I2xJOW7XopTLFSJ9q7O5fibUWvVSmGOdTjZ2Zk86iqaugRhxNtz93skJt3WqQ9a5BYOfLRLpkoEMIKrWzSrpuoPmnGl1q0OdNaQs7xZtwr8P8Z6vKd7Jt6+qF5L2K9LLppXMoEbW0m6oWkrcSZOU72Ho4iybN3LxqdxhcUDYFaomnzaLKomvfbi8oW/YdIFoYhLchzxEUSkW0y5xh7tnuUoPWQf/qc446rydo2rxlwzGUblFDLN9/doP8mUiWkyB8gUqmeduJU6gr3wAXQUXfOMRCea0bS1YEtlkR8EaXBiah37e+QFDlwue8oGl792pB8ctVIKhy6XxOT7ommMJZ3UsFRU9gDZoFTXaZoMWMLdXHSVBZDcKj2OU1elrEuAsqOorxOuiambP6iQUtJw1GX0lf6mcKf2NpTbeonPJ+bTtsDz2pp+hO8y3ySre8ok6Cwh599JOj7oLOq/nU3M2DIffax5GBPkPQrrI2A+0vaEoKRKWvsKTKjT1JUFyGjpxe/Ha7zUBHEBQahy2r8bO2XhpO7OeegpJEZV4sb1J6zuyxgrJ+Dvd3e0E7h6ZlSfx5Nv7nSPrmgZen+11y+MQuZG8e2CVdfGibUiFFleZH3uaBXdJN2bm1hmmbBxamuw2dBJUlH+3xX0gQIEGABAESBEgQIEGABAESBLgKegISBEgQIEGABAESBEgQIEGABAESBEgQIEGAm6DwwUHxJwh18ZXR1aPJ+mmOLbnDjcKhlMZXRR8YTdpPc9LhF77ISZuW0QdGk7VtThiSRXehRXiJC+Jro2tHk7f1YX25yqtKhdC67LWjSfrxYK6GgwiqH03SjxOaQbsJowNpyV6/xjsLGqsGHSmLfoIGLNJHDqx+66ABD/NaKHJivdV4BxIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBDQX1D9CLYtHLfiBoI2AfuCXC/k6YkE/ep9/kXI+Rd9omt+1stU5pvJlX351SyWXvrXdIgeSWs6j8Wkl8pZFJXMkfXnfC37z2mMvciuGLRsY2NBSej2ksNXCLJYkGVhbxdkoRitl9YlYS8XFJmK9jjtYnuCoq8MSFB6FNt8m2JTsdcj+l7IEwUl66Bou9dVzapuWeb8+9xZB2WVvd0QPZIeZ7DhTMONaLDhTIONyGcnOceAQxoLCQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQL+AJuKMfXrP15BAAAAAElFTkSuQmCC" alt /><!-- --></p>
<p>And here correcting by columbia</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotadj &lt;-<span class="st"> </span><span class="kw">colcorrect</span>(phenolong,<span class="dt">pheno=</span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>),<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>,<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>),<span class="dt">lineid=</span><span class="st">&quot;accession&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">cast</span>(meta.experiment+experiment+facility+treatment+accession+plantID~variable)
<span class="kw">plot</span>(fruitnum~days.to.bolt,<span class="dt">data=</span>plotdf,<span class="dt">main=</span><span class="st">&quot;unadjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum~days.to.bolt,<span class="dt">data=</span>plotadj,<span class="dt">main=</span><span class="st">&quot;adjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>And finally, scaling by stddev and then centering data on columbia</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotadj &lt;-<span class="st"> </span>phenolong %&gt;%
<span class="co">#  filter(variable %in% c(&quot;fruitnum&quot;,&quot;days.to.bolt&quot;)) %&gt;%</span>
<span class="st">  </span><span class="kw">scalePhenos</span>(<span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>,<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>),<span class="dt">lineid=</span><span class="st">&quot;accession&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">colcorrect</span>(,<span class="dt">pheno=</span><span class="kw">c</span>(<span class="st">&quot;fruitnum&quot;</span>,<span class="st">&quot;days.to.bolt&quot;</span>), <span class="dt">classifier =</span> <span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>,<span class="st">&quot;facility&quot;</span>,<span class="st">&quot;experiment&quot;</span>),<span class="dt">lineid=</span><span class="st">&quot;accession&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">cast</span>(meta.experiment+experiment+facility+treatment+accession+plantID~variable)

<span class="kw">plot</span>(fruitnum~days.to.bolt,<span class="dt">data=</span>plotdf,<span class="dt">main=</span><span class="st">&quot;unadjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitnum~days.to.bolt,<span class="dt">data=</span>plotadj,<span class="dt">main=</span><span class="st">&quot;adjusted&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
